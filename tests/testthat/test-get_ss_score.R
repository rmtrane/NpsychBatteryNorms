testthat::test_that("get_ss_score", {
  # T1 through T6 + D (distractor list) + LB (Long Delay)
  T1 <- c(0, 2, 3, 6, 8, 10, 12, 14, 15, 16, 18, 19, 20, 20, 20, 20)
  T2 <- c(0, 0, 1, 3, 4, 6, 8, 9, 11, 12, 13, 15, 16, 17, 18, 20)
  T3 <- c(0, 0, 1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 15, 16, 18)
  T4 <- c(0, 0, 0, 1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 13, 15, 17)
  T5 <- c(0, 0, 0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16)
  T6 <- c(2, 4, 4, 5, 6, 7, 8, 9, 10, 11, 11, 12, 13, 14, 15, 17)
  D <- c(3, 4, 5, 6, 7, 8, 8, 9, 10, 11, 12, 12, 13, 14, 15, 17)
  LB <- c(2, 4, 6, 7, 9, 11, 13, 14, 16, 17, 18, 19, 20, 20, 20, 20)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY1REC"), T1)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY2REC"), T2)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY3REC"), T3)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY4REC"), T4)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY5REC"), T5)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REY6REC"), T6)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REYDREC"), D)

  testthat::expect_equal(get_ss_score(0:15, var_name = "REYDLIST"), LB)

  # Sum of Trials 1-5
  Sum1_5 <- 0:75
  Sum1_5ss <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 15, 15, 15, 15, 16, 16, 17, 17, 18, 18, 19, 20, 20, 20, 20, 20, 20, 20)

  testthat::expect_equal(Sum1_5ss, get_ss_score(Sum1_5, var_name = "REYTOTAL"))

  # Percentage correct
  RPC <- round((0:30)/30 * 100)
  RPCss <- c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 4, 5, 5, 6, 7, 8, 8, 9, 11, 12, 15)

  testthat::expect_equal(RPCss, get_ss_score(RPC, var_name = "REYAREC"))

  # Animals
  CFA <- 0:77
  CFAss <- c(0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 3, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 16, 17, 17, 18, 18, 18, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20)

  testthat::expect_equal(CFAss, get_ss_score(CFA, var_name = "ANIMALS"))

  # Veg
  CFV <- 0:77
  CFVss <- c(0, 0, 0, 0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 12, 13, 13, 14, 15, 15, 16, 17, 17, 18, 18, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20)

  testthat::expect_equal(CFVss, get_ss_score(CFV, var_name = "VEG"))

  # Trails A
  TMTA <- 0:150
  TMTAss <- c(20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 19, 19, 18, 17, 17, 16, 16, 15, 15, 14, 14, 13, 13, 12, 12, 12, 11, 11, 11, 11, 10, 10, 10, 10, 9, 9, 9, 9, 8, 8, 8, 8, 8, 7, 7, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  testthat::expect_equal(TMTAss, get_ss_score(TMTA, var_name = "TRAILA"))

  # Trails B
  TMTB <- 0:300
  TMTBss <- c(20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 19, 19, 19, 18, 18, 17, 17, 17, 17, 16, 16, 16, 16, 15, 15, 15, 15, 15, 14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 11, 11, 11, 11, 11, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2)

  testthat::expect_equal(TMTBss, get_ss_score(TMTB, var_name = "TRAILB"))

  # WAIS
  DS <- 0:93
  DSss <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 6, 6, 6, 6, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 19, 20, 20)

  testthat::expect_equal(DSss, get_ss_score(DS, var_name = "WAIS"))
})
